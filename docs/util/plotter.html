<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>scrilla.util.plotter API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>scrilla.util.plotter</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import os, datetime
from typing import Union
import numpy, matplotlib
from PIL import Image

from matplotlib.figure import Figure
from matplotlib import dates as mdates

from scrilla import settings
from scrilla.static import formats, keys
from scrilla.errors import InputValidationError
from scrilla.util import dater

APP_ENV=os.environ.setdefault(&#39;APP_ENV&#39;, &#39;local&#39;)

if APP_ENV == &#39;local&#39;:
    from matplotlib.backends.backend_qt5agg import FigureCanvasQTAgg as FigureCanvas
    matplotlib.use(&#34;Qt5Agg&#34;)
elif APP_ENV == &#39;container&#39;:
    from matplotlib.backends.backend_agg import FigureCanvasAgg as FigureCanvas
    matplotlib.use(&#34;agg&#34;)

def _show_or_save(canvas: FigureCanvas, show: bool, savefile: str) -&gt; Union[FigureCanvas, None]:
    if savefile is not None:
        canvas.print_jpeg(filename_or_obj=savefile)

    if show:
        s, (width, height) = canvas.print_to_buffer()
        im = Image.frombytes(&#34;RGBA&#34;, (width, height), s)
        im.show()
        return None
    canvas.draw()
    return canvas

def plot_qq_series(ticker: str, sample: list, show: bool=True, savefile: str=None) -&gt; Union[FigureCanvas, None]:
    title = f&#39;{ticker} Return Q-Q Plot&#39;
    normal_series = []
    sample_series = []
    for point in sample:
        normal_series.append(point[0])
        sample_series.append(point[1])

    canvas = FigureCanvas(Figure())
    axes = canvas.figure.subplots()

    axes.plot(normal_series, sample_series, linestyle=&#34;None&#34;, marker=&#34;.&#34;, markersize=10.0)
    axes.plot(normal_series, normal_series)
    axes.grid()
    axes.set_xlabel(&#39;Normal Percentiles&#39;)
    axes.set_ylabel(&#39;Sample Percentiles&#39;)
    axes.set_title(title)

    return _show_or_save(canvas=canvas, show=show, savefile=savefile)

def plot_correlation_series(tickers: list, series: dict, show: bool=True, savefile: str=None) -&gt; Union[FigureCanvas, None]:
    start, end = list(series.keys())[-1], list(series.keys())[0]
    title = f&#39;({tickers[0]}, {tickers[1]}) correlation time series&#39;
    subtitle = f&#39;{start} to {end}, rolling {settings.DEFAULT_ANALYSIS_PERIOD}-day estimate&#39;

    canvas = FigureCanvas(Figure())
    figure = canvas.figure
    axes = figure.subplots()

    locator = mdates.AutoDateLocator()
    formatter = mdates.AutoDateFormatter(locator)

    correl_history, dates= [], []
    for date in series:
        dates.append(dater.parse_date_string(date))
        correl_history.append(series[date])

    axes.plot(dates, correl_history)
    axes.grid()
    axes.xaxis.set_major_locator(locator)
    axes.xaxis.set_major_formatter(formatter)
    axes.set_ylabel(&#39;Correlation&#39;)
    axes.set_xlabel(&#39;Dates&#39;)
    axes.set_title(subtitle, fontsize=12)
    figure.suptitle(title, fontsize=18)
    figure.autofmt_xdate()

    return _show_or_save(canvas=canvas, show=show, savefile=savefile)

def plot_frontier(portfolio, frontier, show=True, savefile=None):
    title = &#34; (&#34;
    for i, item in enumerate(portfolio.tickers):
        if i != (len(portfolio.tickers) - 1):
            title += item + &#34;, &#34;
        else:
            title += item + &#34;) Efficient Frontier&#34;
    
    return_profile, risk_profile = [], []
    for allocation in frontier:
        return_profile.append(portfolio.return_function(allocation))
        risk_profile.append(portfolio.volatility_function(allocation))

    canvas = FigureCanvas(Figure())
    axes = canvas.figure.subplots()

    axes.plot(risk_profile, return_profile, linestyle=&#39;dashed&#39;)
    axes.grid()
    axes.set_xlabel(&#39;Volatility&#39;)
    axes.set_ylabel(&#39;Return&#39;)
    axes.set_title(title)

    return _show_or_save(canvas=canvas, show=show, savefile=savefile)

def plot_yield_curve(yield_curve, show=True, savefile=None):
    title = f&#39;US Treasury Yield Curve On {list(yield_curve.keys())[0]}&#39;

    canvas = FigureCanvas(Figure())
    axes = canvas.figure.subplots()

    maturities, rates = [], yield_curve[list(yield_curve.keys())[0]]
    yield_map = keys.keys[&#39;SERVICES&#39;][&#39;STATISTICS&#39;][&#39;QUANDL&#39;][&#39;MAP&#39;][&#39;YIELD_CURVE&#39;]
    for i, rate in enumerate(rates):
        maturities.append(yield_map[keys.keys[&#39;YIELD_CURVE&#39;][i]])

    axes.plot(maturities, rates, linestyle=&#34;dashed&#34;, marker= &#34;.&#34;, markersize=10.0)
    axes.grid()
    axes.set_xlabel(&#39;Maturity&#39;)
    axes.set_ylabel(&#39;Annual Yield&#39;)
    axes.set_title(title)

    return _show_or_save(canvas=canvas, show=show, savefile=savefile)

def plot_profiles(symbols, profiles, show=True, savefile=None, subtitle=None):
    canvas = FigureCanvas(Figure())

    no_symbols = len(symbols)
    axes = canvas.figure.subplots()

    title =&#34;(&#34;
    for symbol in symbols:
        if symbols.index(symbol) != (len(symbols)-1):
            title += symbol +&#34;, &#34;
        else:
            title += symbol +&#39;) Risk-Return Profile&#39;
            if subtitle is not None:
                title += &#34;\n&#34; + subtitle

    return_profile, risk_profile = [], []
    for profile in profiles:
        return_profile.append(profiles[profile][&#39;annual_return&#39;])
        risk_profile.append(profiles[profile][&#39;annual_volatility&#39;])

    axes.plot(risk_profile, return_profile, linestyle=&#39;None&#39;, marker= &#34;.&#34;, markersize=10.0)
    axes.grid()
    axes.set_xlabel(&#39;Volatility&#39;)
    axes.set_ylabel(&#39;Return&#39;)
    axes.set_title(title)

    for i in range(no_symbols):
        axes.annotate(symbols[i], (risk_profile[i], return_profile[i]))

    return _show_or_save(canvas=canvas, show=show, savefile=savefile)

    # TODO: figure out date formatting for x-axis

def plot_moving_averages(symbols, averages_output, periods, show=True, savefile=None):
    averages, dates = averages_output
    canvas = FigureCanvas(Figure())
    axes = canvas.figure.subplots()
    ma1_label, ma2_label, ma3_label = f&#39;MA({periods[0]})&#39;, f&#39;MA({periods[1]})&#39;, f&#39;MA({periods[2]})&#39;

    if dates is None:
        ma1s, ma2s, ma3s = [], [], []
        for i in range(len(symbols)):
            ma1s.append(averages[i][0])
            ma2s.append(averages[i][1])
            ma3s.append(averages[i][2])
    
        width = formats.formats[&#39;BAR_WIDTH&#39;]
        x = numpy.arange(len(symbols))

        axes.bar(x + width, ma1s, width, label=ma1_label)
        axes.bar(x, ma2s, width, label=ma2_label)
        axes.bar(x - width, ma3s, width, label=ma3_label)

        axes.set_ylabel(&#39;Annual Logarithmic Return&#39;)
        axes.set_title(&#39;Moving Averages of Annualized Daily Return Grouped By Equity&#39;)
        axes.set_xticks(x)
        axes.set_xticklabels(symbols)
        axes.legend()

    else:
        
        # TODO: generate different locators based on length of period
        x = [datetime.datetime.strptime(dater.date_to_string(date), &#39;%Y-%m-%d&#39;).toordinal() for date in dates]
        date_locator = matplotlib.dates.WeekdayLocator(byweekday=(matplotlib.dates.WE))
        date_format = matplotlib.dates.DateFormatter(&#39;%m-%d&#39;)
        
        for i, item in enumerate(symbols):
            ma1s, ma2s, ma3s = [], [], []
            ma1_label, ma2_label, ma3_label = f&#39;{item}_{ma1_label}&#39;, f&#39;{item}_{ma2_label}&#39;, f&#39;{item}_{ma3_label}&#39;
            for j in range(len(dates)):
                MA_1 = averages[i][0][j]
                ma1s.append(MA_1)
                                  
                MA_2 = averages[i][1][j]
                ma2s.append(MA_2)
         
                MA_3 = averages[i][2][j]
                ma3s.append(MA_3)
            
            start_date, end_date = dates[0], dates[-1] 
            title_str = f&#39;Moving Averages of Annualized Return From {start_date} to {end_date}&#39;

            axes.plot(x, ma1s, linestyle=&#34;solid&#34;, color=&#34;darkgreen&#34;, label=ma1_label)
            axes.plot(x, ma2s, linestyle=&#34;dotted&#34;, color=&#34;gold&#34;, label=ma2_label)
            axes.plot(x, ma3s, linestyle=&#34;dashdot&#34;, color=&#34;orangered&#34;, label=ma3_label)

        axes.set_title(title_str)
        axes.set_ylabel(&#39;Annualized Logarthmic Return&#39;)
        axes.set_xlabel(&#39;Dates&#39;)
        axes.xaxis.set_major_locator(date_locator)
        axes.xaxis.set_major_formatter(date_format)
        
        axes.legend()

    return _show_or_save(canvas=canvas, show=show, savefile=savefile)

def plot_cashflow(ticker, cashflow, show=True, savefile=None):
    if not cashflow.beta or not cashflow.alpha or len(cashflow.sample) &lt; 3:
        raise InputValidationError(&#34;Cashflow model does not contain enough information to be plotted&#34;)
    
    canvas = FigureCanvas(Figure())
    figure = canvas.figure
    axes = figure.subplots()

    date_format = mdates.DateFormatter(&#39;%m-%d&#39;)

    sup_title_str = f&#39;{ticker} Dividend Linear Regression Model&#39;
    title_str = f&#39;NPV(dividends | discount = {round(cashflow.discount_rate,4)}) = $ {round(cashflow.calculate_net_present_value(), 2)}&#39;

    dividend_history, ordinal_x, dates= [], [], []
    for date in cashflow.sample:
        dates.append(date)
        ordinal_x.append(datetime.datetime.strptime(date, &#39;%Y-%m-%d&#39;).toordinal())
        dividend_history.append(cashflow.sample[date])

    dates.reverse()
    
    model_map = list(map(lambda x: cashflow.alpha + cashflow.beta*x, cashflow.time_series))
    
    axes.scatter(ordinal_x, dividend_history, marker=&#34;.&#34;)
    axes.plot(ordinal_x, model_map)
    axes.grid()
    # axes.xaxis.set_major_formatter(date_format)
    axes.set_xticklabels(dates)
    axes.set_ylabel(&#39;Dividend Amount&#39;)
    axes.set_xlabel(&#39;Payment Date&#39;)
    axes.set_title(title_str, fontsize=12)
    figure.suptitle(sup_title_str, fontsize=18)
    figure.autofmt_xdate()

    return _show_or_save(canvas=canvas, show=show, savefile=savefile)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="scrilla.util.plotter.plot_cashflow"><code class="name flex">
<span>def <span class="ident">plot_cashflow</span></span>(<span>ticker, cashflow, show=True, savefile=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def plot_cashflow(ticker, cashflow, show=True, savefile=None):
    if not cashflow.beta or not cashflow.alpha or len(cashflow.sample) &lt; 3:
        raise InputValidationError(&#34;Cashflow model does not contain enough information to be plotted&#34;)
    
    canvas = FigureCanvas(Figure())
    figure = canvas.figure
    axes = figure.subplots()

    date_format = mdates.DateFormatter(&#39;%m-%d&#39;)

    sup_title_str = f&#39;{ticker} Dividend Linear Regression Model&#39;
    title_str = f&#39;NPV(dividends | discount = {round(cashflow.discount_rate,4)}) = $ {round(cashflow.calculate_net_present_value(), 2)}&#39;

    dividend_history, ordinal_x, dates= [], [], []
    for date in cashflow.sample:
        dates.append(date)
        ordinal_x.append(datetime.datetime.strptime(date, &#39;%Y-%m-%d&#39;).toordinal())
        dividend_history.append(cashflow.sample[date])

    dates.reverse()
    
    model_map = list(map(lambda x: cashflow.alpha + cashflow.beta*x, cashflow.time_series))
    
    axes.scatter(ordinal_x, dividend_history, marker=&#34;.&#34;)
    axes.plot(ordinal_x, model_map)
    axes.grid()
    # axes.xaxis.set_major_formatter(date_format)
    axes.set_xticklabels(dates)
    axes.set_ylabel(&#39;Dividend Amount&#39;)
    axes.set_xlabel(&#39;Payment Date&#39;)
    axes.set_title(title_str, fontsize=12)
    figure.suptitle(sup_title_str, fontsize=18)
    figure.autofmt_xdate()

    return _show_or_save(canvas=canvas, show=show, savefile=savefile)</code></pre>
</details>
</dd>
<dt id="scrilla.util.plotter.plot_correlation_series"><code class="name flex">
<span>def <span class="ident">plot_correlation_series</span></span>(<span>tickers: list, series: dict, show: bool = True, savefile: str = None) ‑> Optional[matplotlib.backends.backend_qt5agg.FigureCanvasQTAgg]</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def plot_correlation_series(tickers: list, series: dict, show: bool=True, savefile: str=None) -&gt; Union[FigureCanvas, None]:
    start, end = list(series.keys())[-1], list(series.keys())[0]
    title = f&#39;({tickers[0]}, {tickers[1]}) correlation time series&#39;
    subtitle = f&#39;{start} to {end}, rolling {settings.DEFAULT_ANALYSIS_PERIOD}-day estimate&#39;

    canvas = FigureCanvas(Figure())
    figure = canvas.figure
    axes = figure.subplots()

    locator = mdates.AutoDateLocator()
    formatter = mdates.AutoDateFormatter(locator)

    correl_history, dates= [], []
    for date in series:
        dates.append(dater.parse_date_string(date))
        correl_history.append(series[date])

    axes.plot(dates, correl_history)
    axes.grid()
    axes.xaxis.set_major_locator(locator)
    axes.xaxis.set_major_formatter(formatter)
    axes.set_ylabel(&#39;Correlation&#39;)
    axes.set_xlabel(&#39;Dates&#39;)
    axes.set_title(subtitle, fontsize=12)
    figure.suptitle(title, fontsize=18)
    figure.autofmt_xdate()

    return _show_or_save(canvas=canvas, show=show, savefile=savefile)</code></pre>
</details>
</dd>
<dt id="scrilla.util.plotter.plot_frontier"><code class="name flex">
<span>def <span class="ident">plot_frontier</span></span>(<span>portfolio, frontier, show=True, savefile=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def plot_frontier(portfolio, frontier, show=True, savefile=None):
    title = &#34; (&#34;
    for i, item in enumerate(portfolio.tickers):
        if i != (len(portfolio.tickers) - 1):
            title += item + &#34;, &#34;
        else:
            title += item + &#34;) Efficient Frontier&#34;
    
    return_profile, risk_profile = [], []
    for allocation in frontier:
        return_profile.append(portfolio.return_function(allocation))
        risk_profile.append(portfolio.volatility_function(allocation))

    canvas = FigureCanvas(Figure())
    axes = canvas.figure.subplots()

    axes.plot(risk_profile, return_profile, linestyle=&#39;dashed&#39;)
    axes.grid()
    axes.set_xlabel(&#39;Volatility&#39;)
    axes.set_ylabel(&#39;Return&#39;)
    axes.set_title(title)

    return _show_or_save(canvas=canvas, show=show, savefile=savefile)</code></pre>
</details>
</dd>
<dt id="scrilla.util.plotter.plot_moving_averages"><code class="name flex">
<span>def <span class="ident">plot_moving_averages</span></span>(<span>symbols, averages_output, periods, show=True, savefile=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def plot_moving_averages(symbols, averages_output, periods, show=True, savefile=None):
    averages, dates = averages_output
    canvas = FigureCanvas(Figure())
    axes = canvas.figure.subplots()
    ma1_label, ma2_label, ma3_label = f&#39;MA({periods[0]})&#39;, f&#39;MA({periods[1]})&#39;, f&#39;MA({periods[2]})&#39;

    if dates is None:
        ma1s, ma2s, ma3s = [], [], []
        for i in range(len(symbols)):
            ma1s.append(averages[i][0])
            ma2s.append(averages[i][1])
            ma3s.append(averages[i][2])
    
        width = formats.formats[&#39;BAR_WIDTH&#39;]
        x = numpy.arange(len(symbols))

        axes.bar(x + width, ma1s, width, label=ma1_label)
        axes.bar(x, ma2s, width, label=ma2_label)
        axes.bar(x - width, ma3s, width, label=ma3_label)

        axes.set_ylabel(&#39;Annual Logarithmic Return&#39;)
        axes.set_title(&#39;Moving Averages of Annualized Daily Return Grouped By Equity&#39;)
        axes.set_xticks(x)
        axes.set_xticklabels(symbols)
        axes.legend()

    else:
        
        # TODO: generate different locators based on length of period
        x = [datetime.datetime.strptime(dater.date_to_string(date), &#39;%Y-%m-%d&#39;).toordinal() for date in dates]
        date_locator = matplotlib.dates.WeekdayLocator(byweekday=(matplotlib.dates.WE))
        date_format = matplotlib.dates.DateFormatter(&#39;%m-%d&#39;)
        
        for i, item in enumerate(symbols):
            ma1s, ma2s, ma3s = [], [], []
            ma1_label, ma2_label, ma3_label = f&#39;{item}_{ma1_label}&#39;, f&#39;{item}_{ma2_label}&#39;, f&#39;{item}_{ma3_label}&#39;
            for j in range(len(dates)):
                MA_1 = averages[i][0][j]
                ma1s.append(MA_1)
                                  
                MA_2 = averages[i][1][j]
                ma2s.append(MA_2)
         
                MA_3 = averages[i][2][j]
                ma3s.append(MA_3)
            
            start_date, end_date = dates[0], dates[-1] 
            title_str = f&#39;Moving Averages of Annualized Return From {start_date} to {end_date}&#39;

            axes.plot(x, ma1s, linestyle=&#34;solid&#34;, color=&#34;darkgreen&#34;, label=ma1_label)
            axes.plot(x, ma2s, linestyle=&#34;dotted&#34;, color=&#34;gold&#34;, label=ma2_label)
            axes.plot(x, ma3s, linestyle=&#34;dashdot&#34;, color=&#34;orangered&#34;, label=ma3_label)

        axes.set_title(title_str)
        axes.set_ylabel(&#39;Annualized Logarthmic Return&#39;)
        axes.set_xlabel(&#39;Dates&#39;)
        axes.xaxis.set_major_locator(date_locator)
        axes.xaxis.set_major_formatter(date_format)
        
        axes.legend()

    return _show_or_save(canvas=canvas, show=show, savefile=savefile)</code></pre>
</details>
</dd>
<dt id="scrilla.util.plotter.plot_profiles"><code class="name flex">
<span>def <span class="ident">plot_profiles</span></span>(<span>symbols, profiles, show=True, savefile=None, subtitle=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def plot_profiles(symbols, profiles, show=True, savefile=None, subtitle=None):
    canvas = FigureCanvas(Figure())

    no_symbols = len(symbols)
    axes = canvas.figure.subplots()

    title =&#34;(&#34;
    for symbol in symbols:
        if symbols.index(symbol) != (len(symbols)-1):
            title += symbol +&#34;, &#34;
        else:
            title += symbol +&#39;) Risk-Return Profile&#39;
            if subtitle is not None:
                title += &#34;\n&#34; + subtitle

    return_profile, risk_profile = [], []
    for profile in profiles:
        return_profile.append(profiles[profile][&#39;annual_return&#39;])
        risk_profile.append(profiles[profile][&#39;annual_volatility&#39;])

    axes.plot(risk_profile, return_profile, linestyle=&#39;None&#39;, marker= &#34;.&#34;, markersize=10.0)
    axes.grid()
    axes.set_xlabel(&#39;Volatility&#39;)
    axes.set_ylabel(&#39;Return&#39;)
    axes.set_title(title)

    for i in range(no_symbols):
        axes.annotate(symbols[i], (risk_profile[i], return_profile[i]))

    return _show_or_save(canvas=canvas, show=show, savefile=savefile)

    # TODO: figure out date formatting for x-axis</code></pre>
</details>
</dd>
<dt id="scrilla.util.plotter.plot_qq_series"><code class="name flex">
<span>def <span class="ident">plot_qq_series</span></span>(<span>ticker: str, sample: list, show: bool = True, savefile: str = None) ‑> Optional[matplotlib.backends.backend_qt5agg.FigureCanvasQTAgg]</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def plot_qq_series(ticker: str, sample: list, show: bool=True, savefile: str=None) -&gt; Union[FigureCanvas, None]:
    title = f&#39;{ticker} Return Q-Q Plot&#39;
    normal_series = []
    sample_series = []
    for point in sample:
        normal_series.append(point[0])
        sample_series.append(point[1])

    canvas = FigureCanvas(Figure())
    axes = canvas.figure.subplots()

    axes.plot(normal_series, sample_series, linestyle=&#34;None&#34;, marker=&#34;.&#34;, markersize=10.0)
    axes.plot(normal_series, normal_series)
    axes.grid()
    axes.set_xlabel(&#39;Normal Percentiles&#39;)
    axes.set_ylabel(&#39;Sample Percentiles&#39;)
    axes.set_title(title)

    return _show_or_save(canvas=canvas, show=show, savefile=savefile)</code></pre>
</details>
</dd>
<dt id="scrilla.util.plotter.plot_yield_curve"><code class="name flex">
<span>def <span class="ident">plot_yield_curve</span></span>(<span>yield_curve, show=True, savefile=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def plot_yield_curve(yield_curve, show=True, savefile=None):
    title = f&#39;US Treasury Yield Curve On {list(yield_curve.keys())[0]}&#39;

    canvas = FigureCanvas(Figure())
    axes = canvas.figure.subplots()

    maturities, rates = [], yield_curve[list(yield_curve.keys())[0]]
    yield_map = keys.keys[&#39;SERVICES&#39;][&#39;STATISTICS&#39;][&#39;QUANDL&#39;][&#39;MAP&#39;][&#39;YIELD_CURVE&#39;]
    for i, rate in enumerate(rates):
        maturities.append(yield_map[keys.keys[&#39;YIELD_CURVE&#39;][i]])

    axes.plot(maturities, rates, linestyle=&#34;dashed&#34;, marker= &#34;.&#34;, markersize=10.0)
    axes.grid()
    axes.set_xlabel(&#39;Maturity&#39;)
    axes.set_ylabel(&#39;Annual Yield&#39;)
    axes.set_title(title)

    return _show_or_save(canvas=canvas, show=show, savefile=savefile)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="scrilla.util" href="index.html">scrilla.util</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="scrilla.util.plotter.plot_cashflow" href="#scrilla.util.plotter.plot_cashflow">plot_cashflow</a></code></li>
<li><code><a title="scrilla.util.plotter.plot_correlation_series" href="#scrilla.util.plotter.plot_correlation_series">plot_correlation_series</a></code></li>
<li><code><a title="scrilla.util.plotter.plot_frontier" href="#scrilla.util.plotter.plot_frontier">plot_frontier</a></code></li>
<li><code><a title="scrilla.util.plotter.plot_moving_averages" href="#scrilla.util.plotter.plot_moving_averages">plot_moving_averages</a></code></li>
<li><code><a title="scrilla.util.plotter.plot_profiles" href="#scrilla.util.plotter.plot_profiles">plot_profiles</a></code></li>
<li><code><a title="scrilla.util.plotter.plot_qq_series" href="#scrilla.util.plotter.plot_qq_series">plot_qq_series</a></code></li>
<li><code><a title="scrilla.util.plotter.plot_yield_curve" href="#scrilla.util.plotter.plot_yield_curve">plot_yield_curve</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>